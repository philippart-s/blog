---
title: "Gitpod √† la place d'Intellij ou de VSCode ?"
classes: wide
#excerpt: ""
categories:
  - Articles
  - IDE
  
tags:
  - Gitpod
  - VSCode
  - Intellij

---
Depuis maintenant deux ou trois ans on entends de plus en plus parler d'IDE dans le cloud.
Je dois reconna√Ætre que ce n'√©tait pas quelque chose qui me faisait envie, le c√¥t√© navigateur, et si on rafra√Æchit la page, on appuie sur pr√©c√©dent, ...
Bref je n'√©tais pas pr√™t et en toute honn√™tet√© je ne trouvais pas les produits m√ªrs.

Mais comme on dit il n'y a que les imb√©ciles qui ne changent pas d'avis, et heureusement je commence √† changer d'avis üòÖ.
A tel point que je me pose la question si je ne vais pas commencer √† me passer de mon installation Intellij tellement choy√©e depuis plus de 15 ans !

# Les use cases

Les raisons pour lesquelles je me suis int√©ress√©e aux IDE dans le cloud sont multiples, plus ou moins utiles !

## La maturit√© des produits
Que ce soit [Code Ready Workspaces](https://developers.redhat.com/products/codeready-workspaces/overview){:target="_blank"}, [Code Spaces](https://github.com/features/codespaces){:target="_blank"} ou [Gitpod](https://gitpod.io/){:target="_blank"} force est de reconna√Ætre que les produits sont de plus en plus aboutis.
On sent moins le c√¥t√© navigateur et exp√©rimental.
J'ai utilis√© pas mal de fois Code Spaces pour faire de petites modifications rapides sur mon code sur GitHub.

## La maturit√© de VSCode
Je suis tomb√©, comme beaucoup, sous le charme de VSCode et je l'utilisais au quotidien comme √©diteur de code / texte pour tout ce qui est autre que le Java.
En effet, je n'arrivais pas √† retrouver la facilit√© / fluidit√© d'utilisation que j'avais dans Intellij ... mais √ßa c'√©tait avant !
Du coup, lorsque je testais je me retrouvais toujours frustrer de ne pas pouvoir tester simplement un d√©veloppement Java !
Mais tout a chang√© avec la release 1.0 de l'[extension VSCode Java](https://github.com/redhat-developer/vscode-java){:target="_blank"} fournie par Red Hat !

En effet, √† partir de la 1.0.0 d√©velopper en Java avec VSCode √©tait vraiment une exp√©rience agr√©able, √† telle point que j'utilise aussi VSCode pour d√©velopper en Java sur mon poste local.
En sachant que ces outils par d√©faut utilisent une version cloud de VSCode IDE (bas√© sur [eclipse Theia](https://github.com/eclipse-theia/theia){:target="_blank"}) il n'en fallait pas plus pour enfin sauter le pas !

## L'utilisation de plusieurs machines
Forc√©ment lorsque l'on parle de cloud cela permet d'envisager l'utilisation de la ressource sur plusieurs machines sans avoir √† r√©installer l'ensemble de la configuration √† chaque fois.
Cela permet aussi d'envisager de travailler sur des machines plus exotiques comme un iPad par exemple.

L'autre bonus est de pouvoir b√©n√©ficier d'un environnement poss√©dant des outils non disponibles ou optimis√©s pour notre machine de tous les jours. 
A titre d'exemple ma machine professionnelle utilise Windows 10 mais je peux avoir besoin d'un linux pour, par exemple, utiliser Docker san virtualisation.

Enfin, lorsque l'on parle de machine on peut b√©n√©ficier d'une configuration beaucoup plus muscl√©e que ce que l'on aurait eu en tant que machine physique (et nous √©vite ainsi de d√©penser √©norm√©ment d'argent !).

## Parceque c'est cool
Comme d'habitude je n'ai pas r√©sist√© √† l'attrait de la nouveaut√© et du coup je me suis pris au jeu de tester cette nouvelle approche de d√©velopper.
Il faut aussi reconna√Ætre qu'√† force de voir des tutos ou talks de Philippe Charri√®re ou Horacio Gonzalez j'ai fini par craquer 

# Le choix du roi ?
Je l'ai rapidement indiqu√© mais √† ce jour il y a plusieurs solutions disponibles.
Je vais rapidement expliquer pourquoi je suis parti sur Gitpod.
Code Ready Workspace (Red Hat) n√©cessite un cluster Openshift, cela limite forc√©ment l'utilisation perso ! 
Code Spaces (GitHub) √©tait un bon candidat mais est devenu payant suite √† l'ouverture de la beta et √† ce jour je ne crois pas qu'il soit ouvert √† titre personnel mais simplement accessible lorsque l'on a un licence business.
Du coup il restait Gitpod, qui en plus est vraiment cool en termes de fonctionnalit√©s mais offre 50h d'utilisation par mois !
C'est largement suffisant pour ce que j'en fais.
Je vous laisse aller voir les [prix](https://www.gitpod.io/pricing/){:target="_blank"} qui sont tout √† fait raisonnables.

On va y venir dans les sections suivantes mais l'autre chose tr√®s sympathique avec Gitpod est qu'il est √©norm√©ment customisable et √ßa pour tout geek qui se respecte √ßa n'a pas de prox.
Les autres le sont aussi certainement mais ne les ayant pas utilis√© je ne peux pas l'affirmer.

## Installation de Gitpod
Eh bien rien √† faire, c'est le but hein !
Juste se connecter sur https://gitpod.io et cr√©er un compte ou utiliser un de vos compte GitHub, GitLab, Bitbucket.

## ConfigurationS
Gitpod est donc un IDE bas√© sur Eclipse Teia dans une image.
L'image par [d√©faut](https://github.com/gitpod-io/workspace-images/blob/master/full/Dockerfile){:target="_blank"} est tr√®s compl√®te et permet d√©j√† de faire pas mal de chose : python, java, node, go, ...
Si c'est largement suffisant pour une utilisation rapide sans trop se poser de questions nous allons voir que nous pouvons un peu (beaucoup üòâ) am√©liorer _l'exp√©rience_ d√©veloppeur.

### Configuration du workspace avec .gitpod.yml
Gitpod vient avec la notion de workspaces, qui repr√©sente en gros une instance de Gitpod sur une branche donn√©e.
Gitpod g√®re le cycle de vie de ces workspaces de mani√®re assez transparente et permet de rouvrir un workspace ferm√© pendant 14 jours (sur la version gratuite) avant de le supprimer.

On peut avoir besoin de configurer de mani√®re sp√©cifique un projet et donc ses workspaces associ√©s, pour cela tout va se passer dans le fichier `.gitpod.yml` √† placer √† la racine du projet.
On peut y configurer de nombreuses choses, comme des actions d'initialisations, des extensions VSCode, exposer des ports, ... 
Je vous laisse aller voir la [documentation](https://www.gitpod.io/docs/references/gitpod-yml){:target="_blank"} qui explique l'ensemble des configurations possibles.

Voici un exemple de d'initialisation que l'on peut faire, dans mon cas je r√©cup√®re les diff√©rentes d√©pendances pour Jekyll :
```yml
tasks:
  - name: Init
    init: bundle install
```
On peut aussi ajouter des actions √† effectuer avant l'ouverture du workspace :
```yml
tasks:
  - name: Init
    before: printf "\n[settings]\napi_key = $WAKATIME_API_KEY\n" > ~/.wakatime.cfg
```
Ici l'exemple de la configuration de [wakatime](https://wakatime.com/){:target="_blank"} en r√©cup√©rant mon API Key positionn√©e dans la [configuration de mon workspace](https://www.gitpod.io/docs/environment-variables#using-the-account-settings){:target="_blank"} dans Gitpod.

Il est aussi possible d'indiquer les extensions que l'on souhaite activer par d√©faut dans notre VSCode : 
```yml
vscode:
  extensions:
    - streetsidesoftware.code-spell-checker-french
    - streetsidesoftware.code-spell-checker
    - github.vscode-pull-request-github
    - eamodio.gitlens
```

Avec ces trois exemples on voit que l'on a deux types de param√©trages : 
 - ceux qui sont propre au projet / workspace, ici le fait d'utiliser Ruby,
 - ceux communs √† tous les projets / workspace, ici la configuration wakatime et les extensions.

Pour √©viter de dupliquer le .gitpod.yml dans tous les projets et de devoir le maintenir √† la main c'est l√† que l'on va commencer √† regarder du c√¥t√© de l'image customisable !

### Configuration du workspace avec une image Docker

Comme indiqu√© pr√©c√©demment Gitpod se base sur une image qui initialise tout un √©cosyst√®me avec les bons outils, pour l'exemple je vais prendre l'image [full](https://github.com/gitpod-io/workspace-images/blob/master/full/Dockerfile){:target="_blank"} mais je pense qu'il serait plus sage et optimal (niveau performance) d'utiliser l'image de [base](https://github.com/gitpod-io/workspace-images/blob/master/base/Dockerfile){:target="_blank"}.
Il y deux moyens d'indiquer quelle image prendre √† la cr√©ation du workspace : 

 - positionner un fichier `.gitpod.Dockerfile` √† la racine du projet puis indiquer dans le `.gitpod.yml` que c'est cette image qui sera utilis√©e : 
```yml
image:
  file: .gitpod.Dockerfile
```
 - cr√©er une image, la publier sur une registry et la r√©f√©renc√©e dans le `.gitpod.yml` : 
```yml
image: wildagsx/gitpod:latest
```
A titre d'exemple voici une image permettant l'utilisation de [Jekyll](https://jekyllrb.com/){:target="_blank"} :
 - configuration de Wakatime
 - installation du bundler et de Jelyll
 - installation de [Oh My Zsh](https://ohmyz.sh/){:target="_blank"} (primordial !) et de ses th√®mes / plugins

Cela donne un Dockerfile assez simple : 
```dockerfile
FROM gitpod/workspace-full

USER gitpod

# Wakatime config
ARG WAKATIME_API_KEY
ENV ZSH=/home/gitpod/.oh-my-zsh

# Set configuration for wakatime
RUN printf "\n[settings]\napi_key = $WAKATIME_API_KEY\n" > ~/.wakatime.cfg \
    # Install Jekyll
    && bash -lc "gem install bundler jekyll" \
    && sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" \
    # Powerlevel10k theme
    && git clone https://github.com/romkatv/powerlevel10k.git $ZSH/custom/themes/powerlevel10k --depth=1 \
    # zsh-autosuggestions plugin
    git clone https://github.com/zsh-users/zsh-autosuggestions $ZSH/custom/plugins/zsh-autosuggestions

#¬†ADD zsh & oh my zsh config file
ADD .zshrc .
# ADD Powerlevel10k theme
ADD .p10k.zsh .
 ```

Pour le tester c'est assez simple : `docker build -f .gitpod.Dockerfile -t wilda/gitpod .` & `docker run -it wilda/gitpod zsh`
```zsh
philipparts-gitpodimages-d3pjrj224nx% docker run -it wilda/gitpod zsh
[powerlevel10k] fetching gitstatusd .. [ok]                                                                                                                           
~                                                                                   with gitpod@5af5c0c59dfa at 16:32:39
‚ùØ 
```
Plut√¥t cool.

Maintenant pour pouvoir utiliser cette image n'importe o√π : `docker push wilda/gitpod`

Ensuite on l'a d√©j√† vu son utilisation va √™tre assez simple, il suffit d'avoir un `.gitpod.yml` de la forme :
```yaml
image: wilda/gitpod
```

Du coup lorsque j'ouvre mon projet dans Gitpod avec ce param√©trage dans le `.gitpod.yaml` j'ai ce genre configuration d'activ√©e : 
```zsh
‚ùØ jekyll -version
jekyll 4.2.1
/workspace/gitpod-images on main                                                                    Ruby 2.7.4 at 16:55:52
‚ùØ  
```

Pour plus de documentation sur comment customiser les images : [documentation GitPod](https://www.gitpod.io/docs/config-docker#custom-docker-image){:target="_blank"}

### Configuration de VSCode
A ce stade on a configur√© une image qui nous convient.
Il reste √† configurer notre VSCode, et notamment les extensions.
Il y a deux moyens : via [Gitpod](https://www.gitpod.io/docs/vscode-extensions/){:target="_blank"} ou via la [synchronisation](https://code.visualstudio.com/docs/editor/settings-sync){:target="_blank"} de de VSCode.


Personnellement j'utilise la synchronisation via VSCode mais celle fournie par Gitpod est int√©ressante car elle permet de choisir si c'est partag√© par tous (propre au projet), pour tous les workspaces de l'utilisateur ou pour un workspace en particulier.
Je vous laisse aller voir la documentation pour plus de d√©tails.
Je vais juste faire un zoom sur un exemple dans un `.gitpod.yml`:
```yaml
image: wilda/gitpod 

vscode:
  extensions:
    - vscjava.vscode-maven
```
Dans cet exemple le projet installera automatiquement l'extension _vscode-maven_ par exemple dans le cas o√π on voudrait √™tre s√ªr de l'avoir si on est sur un projet Java.
Pour savoir quel est le nom de l'extension √† mettre dans le fichier `.gitpod.yml` c'est assez simple car VSCode nous le propose directement sur l'extension (roue crant√©e puis _Add to .gitpod.yml_).

## Conclusion üßê

Merci de m'avoir lu et si vous avez vu des coquilles n'h√©sitez pas √† me l'indiquer sur l'[article](https://github.com/philippart-s/blog){:target="_blank"}. 